"'Initiator Starting Screen' As screen":
    Fill: =Color.White
    LoadingSpinnerColor: =App.Theme.Colors.Primary
    OnVisible: |-
        =UpdateContext({showLoading: false})

    Container13_4 As groupContainer.horizontalAutoLayoutContainer:
        Fill: |
            =RGBA(248, 248, 248, 1)
        Height: =Parent.Height
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width
        ZIndex: =1

        Navigator_4 As Navigator:
            Height: =Parent.Height * 90/100
            LayoutMinHeight: =640
            LayoutMinWidth: =640
            LogOutScreen: ='Login Screen'
            MenuItem: |-
                =Table(
                    {
                        MenuID: 1,
                        MenuIcon: "<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-grid-3x3-gap' viewBox='0 0 16 16'>
                  <path d='M4 2v2H2V2zm1 12v-2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1m0-5V7a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1m0-5V2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1m5 10v-2a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1m0-5V7a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1m0-5V2a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1M9 2v2H7V2zm5 0v2h-2V2zM4 7v2H2V7zm5 0v2H7V7zm5 0h-2v2h2zM4 12v2H2v-2zm5 0v2H7v-2zm5 0v2h-2v-2zM12 1a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zm-1 6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1zm1 4a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1z'/>
                </svg>",
                        MenuName: "Policies",
                        PageNavigation: 'Initiator Starting Screen'
                    }
                  
                )
            OnSelect: ="Text"
            ZIndex: =1

        Container17_3 As groupContainer.verticalAutoLayoutContainer:
            Height: =Parent.Height
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =0
            LayoutMinWidth: =0
            LayoutMode: =LayoutMode.Auto
            ZIndex: =2

            component_Header_4 As component_Header:
                AlignInContainer: =AlignInContainer.Stretch
                LayoutMinHeight: =640
                LayoutMinWidth: =0
                NoficationBellOnSelect: =
                NotificationCircleVisibility: =CountIf('POLICY APPROVALS','Approval Status'=4)>0
                Tooltip: ="You have some items that need your attention"
                Width: =

            Container32_3 As groupContainer.verticalAutoLayoutContainer:
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =20
                PaddingLeft: =20
                PaddingRight: =25
                PaddingTop: =20
                Width: =Parent.Width
                ZIndex: =3

                Container34_3 As groupContainer.verticalAutoLayoutContainer:
                    FillPortions: =0
                    Height: =100
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =1

                    Container38_3 As groupContainer.horizontalAutoLayoutContainer:
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =1.5
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =40
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =18
                        PaddingRight: =10
                        ZIndex: =1

                        Label15_3 As label:
                            BorderColor: =App.Theme.Colors.Darker40
                            Color: =RGBA(0, 0, 0, 1)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FillPortions: =1
                            Font: =App.Theme.Font
                            FontWeight: =FontWeight.Bold
                            LayoutMinWidth: =0
                            Size: =13
                            Text: ="Policies"
                            Width: =Parent.Width
                            ZIndex: =1

                        Container47_2 As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =0
                            Height: =Parent.Height - 25
                            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =3

                            Icon5_2 As icon.Reload:
                                BorderColor: =App.Theme.Colors.Darker40
                                Color: =RGBA(214,221,224,1)
                                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                DisabledColor: =RGBA(244, 244, 244, 1)
                                Height: =30
                                Icon: =Icon.Reload
                                OnSelect: |+
                                    =Refresh('POLICY APPROVALS');
                                    
                                Tooltip: ="Refresh Requests"
                                Width: =30
                                X: =
                                Y: =
                                ZIndex: =1

                            Container40_3 As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                BorderColor: =RGBA(214, 221, 224, 1)
                                BorderThickness: =2
                                FillPortions: =0
                                Height: =Parent.Height
                                LayoutAlignItems: =LayoutAlignItems.Center
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                LayoutMode: =LayoutMode.Auto
                                PaddingLeft: =5
                                PaddingRight: =5
                                RadiusBottomLeft: =5
                                RadiusBottomRight: =5
                                RadiusTopLeft: =5
                                RadiusTopRight: =5
                                Width: =300
                                ZIndex: =2

                                Icon7_3 As icon.Search:
                                    BorderColor: =
                                    Color: =RGBA(214,221,224,1)
                                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                    DisabledColor: =RGBA(244, 244, 244, 1)
                                    Height: =30
                                    Icon: =Icon.Search
                                    Width: =30
                                    ZIndex: =1

                                TextInput3_3 As text:
                                    BorderColor: =App.Theme.Colors.Darker40
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(0, 0, 0, 1)
                                    Default: =
                                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                    DisabledColor: =RGBA(166, 166, 166, 1)
                                    DisabledFill: =RGBA(244, 244, 244, 1)
                                    FillPortions: =1
                                    FocusedBorderThickness: =4
                                    Font: =App.Theme.Font
                                    Height: =Parent.Height
                                    HintText: ="Search by ID or Title"
                                    HoverBorderColor: =App.Theme.Colors.Darker40
                                    HoverColor: =RGBA(0, 0, 0, 1)
                                    HoverFill: =Color.Transparent
                                    LayoutMinWidth: =0
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Size: =8
                                    ZIndex: =2

                                Icon9_2 As icon.Cancel:
                                    BorderColor: =App.Theme.Colors.Darker40
                                    Color: =RGBA(214,221,224,1)
                                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                    DisabledColor: =RGBA(244, 244, 244, 1)
                                    Height: =25
                                    Icon: =Icon.Cancel
                                    OnSelect: =Reset(TextInput3_3)
                                    Visible: =!IsBlank(TextInput3_3.Text)
                                    Width: =25
                                    ZIndex: =3

                            Button10_1 As button:
                                AlignInContainer: =AlignInContainer.Center
                                BorderColor: =App.Theme.Colors.Primary
                                DisabledBorderColor: =RGBA(244, 244, 244, 1)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                Fill: =RGBA(17,65,133,1)
                                Font: =App.Theme.Font
                                FontWeight: =FontWeight.Semibold
                                Height: =Parent.Height
                                HoverBorderColor: =App.Theme.Colors.Darker10
                                HoverColor: =RGBA(255, 255, 255, 1)
                                HoverFill: =ColorFade(RGBA(17,65,133,1), 20%)
                                LayoutMinHeight: =
                                LayoutMinWidth: =0
                                OnSelect: |
                                    =NewForm(Form4_2);
                                    UpdateContext({openForm: true});
                                    Clear(policyDocuments);
                                    Clear(myDocs);
                                    Clear(polNames);
                                PressedBorderColor: =App.Theme.Colors.Darker40
                                PressedColor: =Self.Color
                                PressedFill: =RGBA(17,65,133,1)
                                RadiusBottomLeft: =6
                                RadiusBottomRight: =6
                                RadiusTopLeft: =6
                                RadiusTopRight: =6
                                Size: =10
                                Text: ="âž•New Request"
                                ZIndex: =3

                    Container36_3 As groupContainer.horizontalAutoLayoutContainer:
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =18
                        PaddingRight: =10
                        ZIndex: =3

                        Label16_24 As label:
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =App.Theme.Colors.Darker40
                            Color: =RGBA(159, 159, 159, 1)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            Font: =App.Theme.Font
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.Height
                            Size: =9
                            Text: ="ID"
                            ZIndex: =1

                        Label16_29 As label:
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =App.Theme.Colors.Darker40
                            Color: =RGBA(159, 159, 159, 1)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            FillPortions: =0.5
                            Font: =App.Theme.Font
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.Height
                            Size: =9
                            Text: ="Policy Name"
                            Width: =0
                            ZIndex: =2

                        Label16_31 As label:
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =App.Theme.Colors.Darker40
                            Color: =RGBA(159, 159, 159, 1)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            Font: =App.Theme.Font
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.Height
                            Size: =9
                            Text: ="Status"
                            Width: =100
                            ZIndex: =4

                        Label16_33 As label:
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =App.Theme.Colors.Darker40
                            Color: =RGBA(159, 159, 159, 1)
                            DisabledColor: =RGBA(166, 166, 166, 1)
                            Font: =App.Theme.Font
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.Height
                            Size: =9
                            Text: ="Action"
                            Width: =70
                            ZIndex: =6

                Container37_3 As groupContainer.verticalAutoLayoutContainer:
                    Fill: =RGBA(255, 255, 255, 1)
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =2

                    Gallery2_4 As gallery.galleryVertical:
                        BorderColor: =App.Theme.Colors.Darker40
                        DelayItemLoading: =true
                        Items: =Search('POLICY APPROVALS',TextInput3_3.Text,ID,Title)
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LoadingSpinner: =LoadingSpinner.Data
                        TemplateSize: =50
                        Width: =Parent.Width
                        ZIndex: =1

                        Container42_3 As groupContainer.horizontalAutoLayoutContainer:
                            DropShadow: =DropShadow.Light
                            Height: =Parent.TemplateHeight
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                            LayoutMode: =LayoutMode.Auto
                            PaddingLeft: =18
                            PaddingRight: =10
                            RadiusBottomLeft: =4
                            RadiusBottomRight: =4
                            RadiusTopLeft: =4
                            RadiusTopRight: =4
                            Width: =Parent.TemplateWidth
                            ZIndex: =1

                            Label16_34 As label:
                                BorderColor: =App.Theme.Colors.Darker40
                                Color: |
                                    =RGBA(97, 93, 93, 1)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                Font: =App.Theme.Font
                                FontWeight: =FontWeight.Semibold
                                Height: =Parent.Height
                                Size: =9
                                Text: =ThisItem.ID
                                ZIndex: =1

                            Label16_35 As label:
                                BorderColor: =App.Theme.Colors.Darker40
                                Color: |
                                    =RGBA(97, 93, 93, 1)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                FillPortions: =0.5
                                Font: =App.Theme.Font
                                FontWeight: =FontWeight.Semibold
                                Height: =Parent.Height
                                Size: =9
                                Text: =ThisItem.Title
                                ZIndex: =2

                            Container39_3 As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.Center
                                Fill: =Switch(ThisItem.'Approval Status','Approval Status'.Approved,RGBA(1, 167, 37, 0.1),'Approval Status'.Rejected,RGBA(201, 5, 5, 0.1),RGBA(254,99,9,0.1))
                                FillPortions: =0
                                Height: =30
                                LayoutAlignItems: =LayoutAlignItems.Center
                                LayoutJustifyContent: =LayoutJustifyContent.Center
                                LayoutMinHeight: =0
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                PaddingLeft: =10
                                RadiusBottomLeft: =50
                                RadiusBottomRight: =50
                                RadiusTopLeft: =50
                                RadiusTopRight: =50
                                Width: =100
                                X: =40
                                ZIndex: =5

                                Circle1_3 As circle:
                                    BorderColor: =App.Theme.Colors.Darker40
                                    Fill: |-
                                        =Switch(ThisItem.'Approval Status','Approval Status'.Approved,RGBA(1, 167, 37, 1),'Approval Status'.Rejected,RGBA(201, 5, 5, 1),RGBA(254,99,9,1)
                                        )
                                    Height: =10
                                    Width: =10
                                    ZIndex: =1

                                Label17_3 As label:
                                    AutoHeight: =true
                                    BorderColor: =App.Theme.Colors.Darker40
                                    Color: =Switch(ThisItem.'Approval Status','Approval Status'.Approved,RGBA(1,167,37,1),'Approval Status'.Rejected,RGBA(201,5,5,1),RGBA(254,99,9,1))
                                    DisabledColor: =RGBA(166, 166, 166, 1)
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    FontWeight: =FontWeight.Semibold
                                    LayoutMinWidth: =0
                                    Size: =8
                                    Text: =Switch(ThisItem.'Approval Status','Approval Status'.Approved,"Approved",'Approval Status'.Rejected,"Rejected",'Approval Status'.Pending,"Pending","New")
                                    ZIndex: =3

                            Container44_2 As groupContainer.manualLayoutContainer:
                                FillPortions: =0
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                Width: =70
                                ZIndex: =8

                                Icon8_2 As icon.View:
                                    BorderColor: =App.Theme.Colors.Darker40
                                    Color: =RGBA(214,221,224,1)
                                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                    DisabledColor: =RGBA(244, 244, 244, 1)
                                    Height: =30
                                    Icon: =Icon.View
                                    OnSelect: |-
                                        =UpdateContext({policyItem: ThisItem});
                                        UpdateContext({openForm: true});
                                        Switch(
                                            Gallery2_4.Selected.'Approval Status',
                                            'Approval Status'.Rejected,
                                            EditForm(Form4_2),
                                            ViewForm(Form4_2)
                                        );
                                        ClearCollect(
                                            policyDocuments,
                                            ForAll(
                                                Filter(
                                                    'POLICY DOCUMENTS',
                                                    'Item IDs' = Value(ThisItem.ID)
                                                )As Item,
                                                {
                                                    policyID:Item.ID,
                                                    PolicyName: Item.'POLICY NAME',
                                                    PolicyDocument: "",
                                                    PolicyDocumentURI: "https://orge85073f1.crm4.dynamics.com/api/data/v9.0/owolabi_policydocumentses(" & Item.'POLICY DOCUMENTS' & ")/owolabi_document/$value",
                                                    PolicyDocumentName: Item.'Document Name'
                                                }
                                            )
                                        )
                                    Width: =30
                                    X: =Parent.Width/2 - Self.Width/2
                                    Y: =Parent.Height/2 - Self.Height/2
                                    ZIndex: =1

    "'POP UP_3' As 'POP UP'":
        ActionText: =action
        Height: =Parent.Height
        NoAction: |-
            =UpdateContext({showPopUp:false});
        Visible: =showPopUp
        Width: =Parent.Width
        YesAction: |-
            =Switch(
                action,
                "Submit",
                //submit form
               
                //update approval status to pending
                
                UpdateContext({showPopUp: false});
                UpdateContext({showLoading: true});
                SubmitForm(Form4_2),
                "Delete",
                UpdateContext({showPopUp: false});
                UpdateContext({showLoading: true});
                Remove(
                    'POLICY COMPEDIUMS',
                    LookUp(
                        'POLICY COMPEDIUMS',
                        ID = Gallery2_4.Selected.ID
                    )
                );
                UpdateContext({openForm: false});
                
            )
        ZIndex: =4

    Group1_2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =4

        rect_shadow_2 As rectangle:
            BorderColor: =App.Theme.Colors.Darker40
            Fill: =RGBA(0, 0, 0, 0.3)
            Height: =Parent.Height
            Visible: =openForm
            Width: =Parent.Width
            ZIndex: =2

        Container46_2 As groupContainer.verticalAutoLayoutContainer:
            DropShadow: =DropShadow.Light
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Parent.Height
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =25
            PaddingLeft: =25
            PaddingRight: =25
            PaddingTop: =25
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Visible: =openForm
            Width: =Parent.Width * 60%
            X: =Parent.Width - Self.Width
            ZIndex: =3

            form_header_2 As groupContainer.horizontalAutoLayoutContainer:
                FillPortions: =0
                Height: =50
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutGap: =10
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =1

                Label18_2 As label:
                    BorderColor: =App.Theme.Colors.Darker40
                    Color: =RGBA(4, 4, 4, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    FillPortions: =1
                    Font: =App.Theme.Font
                    FontWeight: =FontWeight.Bold
                    LayoutMinWidth: =0
                    Size: =11
                    Text: ="Policies"
                    ZIndex: =1

            rect_horizontalLine_4 As rectangle:
                AlignInContainer: =AlignInContainer.Stretch
                BorderColor: =App.Theme.Colors.Darker40
                Fill: =RGBA(217,217,217,1)
                Height: =2
                Width: =Parent.Width
                ZIndex: =2

            Container50_2 As groupContainer.verticalAutoLayoutContainer:
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =3

                Label19_3 As label:
                    AlignInContainer: =AlignInContainer.Stretch
                    BorderColor: =App.Theme.Colors.Darker40
                    Color: =RGBA(4, 4, 4, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Semibold
                    Size: =10
                    Text: =Switch(DataCardValue8.Selected.Value, 'Approval Status'.Approved,Gallery2_4.Selected.Title,'Approval Status'.Pending,Gallery2_4.Selected.Title,'Approval Status'.Rejected,Gallery2_4.Selected.Title,"New Request")
                    ZIndex: =1

                Form4_2 As form.PowerApps_CoreControls_Form:
                    BorderColor: =App.Theme.Colors.Darker40
                    DataSource: ='POLICY APPROVALS'
                    DefaultMode: =FormMode.New
                    FillPortions: =2
                    Item: =Gallery2_4.Selected
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    OnFailure: |-
                        =UpdateContext({showLoading:false});Notify(First(Errors('POLICY COMPEDIUMS')).Record.'OWNER NAME'.'Full Name',NotificationType.Error);
                    OnSuccess: |
                        =Set(
                            guid,
                            LookUp(
                                'POLICY APPROVALS',
                                ID = Form4_2.LastSubmit.ID
                            ).'POLICY APPROVALS'
                        );
                        //Update comment if any
                        /*If(
                            Form4_2.Mode = FormMode.New,
                            Set(
                                guid,
                                LookUp(
                                    'POLICY APPROVALS',
                                    ID = Form4_2.LastSubmit.ID
                                ).'POLICY APPROVALS'
                            ),
                            Set(
                                guid,
                                Gallery2_4.Selected.'POLICY APPROVALS'
                            )
                        );*/
                        /*If(
                            Form4_2.Mode = FormMode.Edit,
                            'UpdateCommentlogandCasestatus'.Run(
                                Gallery2_4.Selected.'POLICY APPROVALS',
                                Now(),
                                currentUser.displayName,
                                DataCardValue13.Value
                            ),
                            'UpdateCommentlogandCasestatus'.Run(
                                Form4_2.LastSubmit.'POLICY APPROVALS',
                                Now(),
                                currentUser.displayName,
                                DataCardValue13.Value
                            )
                        );*/
                        'UpdateCommentlogandCasestatus'.Run(
                            Form4_2.LastSubmit.'POLICY APPROVALS',
                            Now(),
                            currentUser.displayName,
                            Form4_2.LastSubmit.Comment
                        );
                        //update item approval status to pending
                        Patch(
                            'POLICY APPROVALS',
                            Form4_2.LastSubmit,
                            {
                                'Approval Status': 'Approval Status'.Pending,
                                Title: Concatenate(
                                    "Policy Renewal for ",
                                    Concat(
                                        polNames,
                                        PolicyName,
                                        " ,"
                                    )
                                )
                            }
                        );
                        //upload all documents to policy documents datasource
                        If(
                            !IsEmpty(myDocs),
                            ForAll(
                                myDocs,
                                SaveDocument.Run(
                                    Form4_2.LastSubmit.ID,
                                    currentUser.displayName,
                                    PolicyName,
                                    {
                                        file: {
                                            contentBytes: PolicyDocument,
                                            name: PolicyDocumentName
                                        }
                                    }
                                )
                            )
                        );
                        Notify(
                            "Policy has been submitted successfully",
                            NotificationType.Success
                        );
                        SendMail.Run(
                            "POLICY RENEWAL REQUEST HAS BEEN SUBMITTED",
                            "<p>Dear Team, <br><br>Please note that a policy renewal request with ID " & Form4_2.LastSubmit.ID & " has been submitted for approval. Kindly <a href='" & appBaseUrl & "&status=approval'>click here</a> to view.<br><br>Regards. </p>",
                            creditRiskEmailAddress
                        );
                        Clear(policyDocuments);
                        Clear(polNames);
                        Clear(myDocs);
                        NewForm(Form4_2);
                        UpdateContext({showLoading: false});
                        UpdateContext({openForm: false});
                    UseFluentV9Cards: =true
                    ZIndex: =2

                    ID_DataCard2 As typedDataCard.fluentV9TextualViewCard:
                        BorderColor: =App.Theme.Colors.Darker40
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="owolabi_id"
                        Default: =ThisItem.ID
                        DisplayMode: =DisplayMode.View
                        DisplayName: =DataSourceInfo([@'POLICY APPROVALS'],DataSourceInfo.DisplayName,owolabi_id)
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        Required: =false
                        Visible: =Form4_2.Mode <> FormMode.New
                        Width: =256
                        WidthFit: =true
                        X: =0
                        Y: =0
                        ZIndex: =10

                        DataCardKey23 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =22
                            Text: =Parent.DisplayName
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =Parent.Width - 48
                            Wrap: =false
                            X: =24
                            Y: =10
                            ZIndex: =1

                        "DataCardValue23 As 'Text input'":
                            BasePaletteColor: =
                            BorderColor: =
                            DisplayMode: =DisplayMode.View
                            Fill: =
                            FontColor: =
                            Height: =32
                            Mode: ="'TextInputCanvas.Mode'.TextInputModeSingleLine"
                            ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                            Value: =Parent.Default
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey23.Y + DataCardKey23.Height + 4
                            ZIndex: =2

                    "'Initiator Name_DataCard4' As typedDataCard.fluentV9TextualEditCard":
                        BorderColor: =App.Theme.Colors.Darker40
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="owolabi_initiatorname"
                        Default: =ThisItem.'Initiator Name'
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'POLICY APPROVALS'],DataSourceInfo.DisplayName,owolabi_initiatorname)
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        MaxLength: =DataSourceInfo([@'POLICY APPROVALS'], DataSourceInfo.MaxLength, owolabi_initiatorname)
                        Required: =true
                        Update: =DataCardValue30.Value
                        Width: =256
                        WidthFit: =true
                        X: =1
                        Y: =0
                        ZIndex: =10

                        DataCardKey31 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =22
                            Text: =Parent.DisplayName
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =Parent.Width - 48
                            Wrap: =false
                            X: =24
                            Y: =10
                            ZIndex: =1

                        "DataCardValue30 As 'Text input'":
                            AccessibleLabel: =Parent.DisplayName
                            BasePaletteColor: =
                            BorderColor: =
                            DisplayMode: =DisplayMode.View
                            Fill: =
                            FontColor: =
                            Height: =32
                            Mode: ="'TextInputCanvas.Mode'.TextInputModeSingleLine"
                            Required: =Parent.Required
                            ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                            Value: =currentUser.displayName
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey31.Y + DataCardKey31.Height + 4
                            ZIndex: =2

                        ErrorMessage26 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue30.Y + DataCardValue30.Height
                            ZIndex: =3

                        StarVisible26 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: ="*"
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey31.Y
                            ZIndex: =4

                    "'Initiator Email Address_DataCard2' As typedDataCard.fluentV9TextualEditCard":
                        BorderColor: =App.Theme.Colors.Darker40
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="owolabi_initiatoremailaddress"
                        Default: =Switch(DataCardValue8.Selected.Value,'Approval Status'.New,currentUser.mail,ThisItem.'Initiator Email Address')
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'POLICY APPROVALS'],DataSourceInfo.DisplayName,owolabi_initiatoremailaddress)
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        MaxLength: =DataSourceInfo([@'POLICY APPROVALS'], DataSourceInfo.MaxLength, owolabi_initiatoremailaddress)
                        Required: =true
                        Update: =DataCardValue27.Value
                        Visible: =false
                        Width: =256
                        WidthFit: =true
                        X: =2
                        Y: =0
                        ZIndex: =10

                        DataCardKey29 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =22
                            Text: =Parent.DisplayName
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =Parent.Width - 48
                            Wrap: =false
                            X: =24
                            Y: =10
                            ZIndex: =1

                        "DataCardValue27 As 'Text input'":
                            AccessibleLabel: =Parent.DisplayName
                            BasePaletteColor: =
                            BorderColor: =
                            DisplayMode: =Parent.DisplayMode
                            Fill: =
                            FontColor: =
                            Height: =32
                            Mode: ="'TextInputCanvas.Mode'.TextInputModeSingleLine"
                            Required: =Parent.Required
                            ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                            Value: =Parent.Default
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey29.Y + DataCardKey29.Height + 4
                            ZIndex: =2

                        ErrorMessage23 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue27.Y + DataCardValue27.Height
                            ZIndex: =3

                        StarVisible23 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: ="*"
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey29.Y
                            ZIndex: =4

                    Group_DataCard4 As typedDataCard.fluentV9ComboBoxOptionSetSingleEditCard:
                        BorderColor: =App.Theme.Colors.Darker40
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="owolabi_group"
                        Default: =ThisItem.Group
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'POLICY APPROVALS'],DataSourceInfo.DisplayName,owolabi_group)
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        Required: =true
                        Update: =DataCardValue20.Selected.Value
                        Width: =256
                        WidthFit: =true
                        X: =0
                        Y: =1
                        ZIndex: =10

                        DataCardKey20 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =22
                            Text: =Parent.DisplayName
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =Parent.Width - 48
                            Wrap: =false
                            X: =24
                            Y: =10
                            ZIndex: =1

                        DataCardValue20 As Combobox.pcfdataset:
                            AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                            DefaultSelectedItems: =[Parent.Default]
                            DisplayMode: =Parent.DisplayMode
                            Height: =32
                            Items: =Choices('Risk Management Groups')
                            Required: =false
                            ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey20.Y + DataCardKey20.Height + 4
                            ZIndex: =2

                        ErrorMessage19 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue20.Y + DataCardValue20.Height
                            ZIndex: =3

                        StarVisible19 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =20
                            Text: ="*"
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey20.Y
                            ZIndex: =4

                    "'Approver Name_DataCard1' As typedDataCard.fluentV9TextualEditCard":
                        BorderColor: =App.Theme.Colors.Darker40
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="owolabi_approvername"
                        Default: =ThisItem.'Approver Name'
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'POLICY APPROVALS'],DataSourceInfo.DisplayName,owolabi_approvername)
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        MaxLength: =DataSourceInfo([@'POLICY APPROVALS'], DataSourceInfo.MaxLength, owolabi_approvername)
                        Required: =false
                        Update: =DataCardValue10.Value
                        Visible: =DataCardValue8.Selected.Value <> 'Approval Status'.New && DataCardValue8.Selected.Value <> 'Approval Status'.Pending
                        Width: =256
                        WidthFit: =true
                        X: =1
                        Y: =1
                        ZIndex: =10

                        DataCardKey12 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =22
                            Text: =Parent.DisplayName
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =Parent.Width - 48
                            Wrap: =false
                            X: =24
                            Y: =10
                            ZIndex: =1

                        "DataCardValue10 As 'Text input'":
                            AccessibleLabel: =Parent.DisplayName
                            BasePaletteColor: =
                            BorderColor: =
                            DisplayMode: =Parent.DisplayMode
                            Fill: =
                            FontColor: =
                            Height: =32
                            Mode: ="'TextInputCanvas.Mode'.TextInputModeSingleLine"
                            Required: =Parent.Required
                            ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                            Value: =Parent.Default
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey12.Y + DataCardKey12.Height + 4
                            ZIndex: =2

                        ErrorMessage10 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue10.Y + DataCardValue10.Height
                            ZIndex: =3

                        StarVisible10 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: ="*"
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey12.Y
                            ZIndex: =4

                    "'Approval Status_DataCard2' As typedDataCard.fluentV9ComboBoxOptionSetSingleEditCard":
                        BorderColor: =App.Theme.Colors.Darker40
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="owolabi_approvalstatus"
                        Default: =ThisItem.'Approval Status'
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'POLICY APPROVALS'],DataSourceInfo.DisplayName,owolabi_approvalstatus)
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        Required: =false
                        Update: =DataCardValue8.Selected.Value
                        Width: =256
                        WidthFit: =true
                        X: =2
                        Y: =1
                        ZIndex: =10

                        DataCardKey9 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =22
                            Text: =Parent.DisplayName
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =Parent.Width - 48
                            Wrap: =false
                            X: =24
                            Y: =10
                            ZIndex: =1

                        DataCardValue8 As Combobox.pcfdataset:
                            AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                            DefaultSelectedItems: |-
                                =
                                If(
                                    Form4_2.Mode = FormMode.New,
                                    LookUp(
                                        Choices('Approval Status'),
                                        Value = 1
                                    ),
                                    If(
                                        Or(Form4_2.Mode = FormMode.Edit,Form4_2.Mode = FormMode.View),
                                        Switch(
                                        Gallery2_4.Selected.'Approval Status', 
                                        'Approval Status'.Approved,
                                        LookUp(
                                            Choices('Approval Status'),
                                            Value = 3),
                                            'Approval Status'.Pending,
                                                LookUp(
                                                    Choices('Approval Status'),
                                                    Value = 2
                                                ),
                                                 'Approval Status'.Rejected,
                                                    LookUp(
                                                        Choices('Approval Status'),
                                                        Value = 4
                                                    )
                                                )
                                            )
                                        )
                                    
                                //LookUp(Choices('Approval Status'),Value = 1)LookUp(Choices('Approval Status'),Value = 1)
                            DisplayMode: =DisplayMode.View
                            FontColor: |-
                                =Switch(
                                    Form4_2.Mode,
                                    FormMode.New,
                                    Color.Black,
                                    FormMode.View,
                                    Switch(
                                        DataCardValue8.Selected.Value,
                                        'Approval Status'.Approved,
                                        Color.Green,
                                        'Approval Status'.Pending,
                                        Color.Brown
                                    ),
                                    FormMode.Edit,
                                    Color.Red
                                )
                                /*If(
                                    DataCardValue8.Selected.Value = 'Approval Status'.Approved,
                                    Color.Green,
                                    If(
                                        DataCardValue8.Selected.Value = 'Approval Status'.Rejected,
                                        Color.Red,
                                        If(
                                            DataCardValue8.Selected.Value = 'Approval Status'.Pending,
                                            Color.Brown,
                                            Color.Black
                                        )
                                    )
                                )*/
                            FontWeight: =FontWeight.Bold
                            Height: =32
                            Items: =Choices('Approval Status')
                            Required: =false
                            ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey9.Y + DataCardKey9.Height + 4
                            ZIndex: =2

                        ErrorMessage4 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue8.Y + DataCardValue8.Height
                            ZIndex: =3

                        StarVisible4 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =20
                            Text: ="*"
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey9.Y
                            ZIndex: =4

                    "'Approver Email Address_DataCard1' As typedDataCard.fluentV9TextualEditCard":
                        BorderColor: =App.Theme.Colors.Darker40
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="owolabi_approveremailaddress"
                        Default: =ThisItem.'Approver Email Address'
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'POLICY APPROVALS'],DataSourceInfo.DisplayName,owolabi_approveremailaddress)
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =70
                        MaxLength: =DataSourceInfo([@'POLICY APPROVALS'], DataSourceInfo.MaxLength, owolabi_approveremailaddress)
                        Required: =false
                        Update: =DataCardValue9.Value
                        Visible: =false
                        Width: =256
                        WidthFit: =true
                        X: =0
                        Y: =2
                        ZIndex: =10

                        DataCardKey10 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =22
                            Text: =Parent.DisplayName
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =Parent.Width - 48
                            Wrap: =false
                            X: =24
                            Y: =10
                            ZIndex: =1

                        "DataCardValue9 As 'Text input'":
                            AccessibleLabel: =Parent.DisplayName
                            BasePaletteColor: =
                            BorderColor: =
                            DisplayMode: =Parent.DisplayMode
                            Fill: =
                            FontColor: =
                            Height: =32
                            Mode: ="'TextInputCanvas.Mode'.TextInputModeSingleLine"
                            Required: =Parent.Required
                            ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                            Value: =Parent.Default
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey10.Y + DataCardKey10.Height + 4
                            ZIndex: =2

                        ErrorMessage7 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue9.Y + DataCardValue9.Height
                            ZIndex: =3

                        StarVisible7 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: ="*"
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey10.Y
                            ZIndex: =4

                    Comment_DataCard4 As typedDataCard.fluentV9TextualMultiLineEditCard:
                        BorderColor: =App.Theme.Colors.Darker40
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="owolabi_comment"
                        Default: =ThisItem.Comment
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'POLICY APPROVALS'],DataSourceInfo.DisplayName,owolabi_comment)
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =166
                        Required: =false
                        Update: =DataCardValue13.Value
                        Width: =256
                        WidthFit: =true
                        X: =1
                        Y: =2
                        ZIndex: =10

                        DataCardKey13 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =22
                            Text: ="Your Comments"
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =Parent.Width - 48
                            Wrap: =false
                            X: =24
                            Y: =10
                            ZIndex: =1

                        "DataCardValue13 As 'Text input'":
                            AccessibleLabel: =Parent.DisplayName
                            BasePaletteColor: =
                            BorderColor: =
                            DisplayMode: =Parent.DisplayMode
                            Fill: =
                            FontColor: =
                            Height: =144
                            Mode: ='TextInputCanvas.Mode'.Multiline
                            Required: =Parent.Required
                            ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                            Value: =Parent.Default
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey13.Y + DataCardKey13.Height + 4
                            ZIndex: =2

                        ErrorMessage14 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue13.Y + DataCardValue13.Height
                            ZIndex: =3

                        StarVisible14 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: ="*"
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey13.Y
                            ZIndex: =4

                    CommentLog_DataCard4 As typedDataCard.fluentV9TextualMultiLineEditCard:
                        BorderColor: =App.Theme.Colors.Darker40
                        BorderStyle: =BorderStyle.Solid
                        DataField: ="owolabi_commentlog"
                        Default: =ThisItem.CommentLog
                        DisplayMode: =Parent.DisplayMode
                        DisplayName: =DataSourceInfo([@'POLICY APPROVALS'],DataSourceInfo.DisplayName,owolabi_commentlog)
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =166
                        Required: =false
                        Update: =DataCardValue17.Value
                        Width: =256
                        WidthFit: =true
                        X: =2
                        Y: =2
                        ZIndex: =10

                        DataCardKey19 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =22
                            Text: =Parent.DisplayName
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =Parent.Width - 48
                            Wrap: =false
                            X: =24
                            Y: =10
                            ZIndex: =1

                        "DataCardValue17 As 'Text input'":
                            AccessibleLabel: =Parent.DisplayName
                            BasePaletteColor: =
                            BorderColor: =
                            DisplayMode: =DisplayMode.View
                            Fill: =
                            FontColor: =
                            Height: =144
                            Mode: ='TextInputCanvas.Mode'.Multiline
                            Required: =Parent.Required
                            ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                            Value: =Parent.Default
                            Width: =Parent.Width - 48
                            X: =24
                            Y: =DataCardKey19.Y + DataCardKey19.Height + 4
                            ZIndex: =2

                        ErrorMessage16 As Text:
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: =Parent.Error
                            Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                            Width: =Parent.Width - 48
                            Wrap: =true
                            X: =24
                            Y: =DataCardValue17.Y + DataCardValue17.Height
                            ZIndex: =3

                        StarVisible16 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =30
                            Text: ="*"
                            Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                            Width: =30
                            X: =0
                            Y: =DataCardKey19.Y
                            ZIndex: =4

                rect_horizontalLine_5 As rectangle:
                    AlignInContainer: =AlignInContainer.Stretch
                    BorderColor: =App.Theme.Colors.Darker40
                    Fill: =RGBA(217,217,217,1)
                    Height: =2
                    Width: =Parent.Width
                    ZIndex: =3

                Label19_4 As label:
                    AlignInContainer: =AlignInContainer.Stretch
                    AutoHeight: =true
                    BorderColor: =App.Theme.Colors.Darker40
                    Color: =RGBA(4, 4, 4, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Semibold
                    Size: =10
                    Text: ="Documents"
                    ZIndex: =4

                Container25_3 As groupContainer.horizontalAutoLayoutContainer:
                    Height: =50
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =50
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =3
                    PaddingLeft: =3
                    PaddingRight: =10
                    PaddingTop: =3
                    Visible: =DataCardValue8.Selected.Value = 'Approval Status'.New || DataCardValue8.Selected.Value = 'Approval Status'.Rejected
                    Width: =
                    ZIndex: =6

                    ComboboxCanvas1_2 As Combobox.pcfdataset:
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =1
                        Height: =32
                        InputTextPlaceholder: ="Select Policy"
                        Items: =Distinct('POLICY COMPEDIUMS','NAME OF POLICY')
                        LayoutMinHeight: =32
                        Required: =false
                        Width: =320
                        X: =0
                        Y: =0
                        ZIndex: =1

                    attach_documents_3 As attachments:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =If(IsBlank(attach_documents_3.Attachments), Color.Red, Color.Black)
                        BorderThickness: =2
                        DisabledBorderColor: =RGBA(166, 166, 166, 1)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        FillPortions: =1
                        FocusedBorderThickness: =4
                        Font: =App.Theme.Font
                        Height: =Parent.Height * 70%
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =App.Theme.Colors.Lighter70
                        IsInDataCard: =true
                        ItemColor: =RGBA(255, 255, 255, 1)
                        ItemFill: =App.Theme.Colors.Primary
                        ItemHoverColor: =RGBA(0, 0, 0, 1)
                        ItemHoverFill: =App.Theme.Colors.Lighter70
                        Items: |-
                            =//colAttachments
                            //If(!IsEmpty(items),Table({Name:LookUp(items,PolicyName = ThisItem.PolicyName).PolicyName},{Value:LookUp(items,PolicyName = ThisItem.PolicyName).PolicyDocument}))
                        LayoutMinHeight: =70
                        LayoutMinWidth: =0
                        MaxAttachments: =1
                        OnAddFile: |
                            =//ClearCollect(colAttachments, Self.Attachments);
                            //Patch(items, ThisItem, { PolicyName: ComboBox1.Selected.Value,PolicyDocument:First(Self.Attachments).Value,PolicyDocumentName:First(Self.Attachments).Name})
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =App.Theme.Colors.Darker30
                        Tooltip: ="Attach documents"
                        Width: =Parent.Width * 0.4
                        X: =361
                        Y: =48
                        ZIndex: =2

                    save_button_2 As button:
                        BorderColor: =RGBA(17,65,133,1)
                        DisabledBorderColor: =RGBA(244, 244, 244, 1)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayMode: |-
                            =If(
                                Or(
                                    IsBlank(ComboboxCanvas1_2.Selected.Value),
                                    IsBlank(First(attach_documents_3.Attachments))
                                ),
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =RGBA(17,65,133,1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Semibold
                        HoverBorderColor: =App.Theme.Colors.Darker10
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(17,65,133,1), 20%)
                        OnSelect: |
                            =Collect(
                                policyDocuments,
                                {
                                    policyID: "",
                                    PolicyName: ComboboxCanvas1_2.Selected.Value,
                                    PolicyDocument: First(attach_documents_3.Attachments).Value,
                                    PolicyDocumentName: First(attach_documents_3.Attachments).Name,
                                    PolicyDocumentURI: ""
                                }
                            );
                            Collect(
                                polNames,
                                {PolicyName: ComboboxCanvas1_2.Selected.Value}
                            );
                            Collect(
                                myDocs,
                                {
                                    policyID: "",
                                    PolicyName: ComboboxCanvas1_2.Selected.Value,
                                    PolicyDocument: First(attach_documents_3.Attachments).Value,
                                    PolicyDocumentName: First(attach_documents_3.Attachments).Name,
                                    PolicyDocumentURI: ""
                                }
                            );
                            Reset(ComboboxCanvas1_2);
                            Reset(attach_documents_3);
                        PressedBorderColor: =App.Theme.Colors.Darker40
                        PressedColor: =Self.Color
                        PressedFill: =App.Theme.Colors.Darker40
                        RadiusBottomLeft: =6
                        RadiusBottomRight: =6
                        RadiusTopLeft: =6
                        RadiusTopRight: =6
                        Size: =10
                        Text: ="âž•Add"
                        Visible: =Switch(DataCardValue8.Selected.Value, 'Approval Status'.Approved,false,'Approval Status'.Pending, false, 'Approval Status'.Rejected,true,true)
                        Width: =100
                        ZIndex: =4

                rect_horizontalLine_6 As rectangle:
                    AlignInContainer: =AlignInContainer.Stretch
                    BorderColor: =App.Theme.Colors.Darker40
                    Fill: =RGBA(217,217,217,1)
                    Height: =2
                    Width: =Parent.Width
                    ZIndex: =7

                Gallery12 As gallery.galleryVertical:
                    BorderColor: =App.Theme.Colors.Darker40
                    DelayItemLoading: =true
                    Items: =policyDocuments
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =320
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =
                    TemplateSize: =40
                    Visible: =true//Form4_2.Mode = FormMode.New
                    ZIndex: =8

                    Container60 As groupContainer.horizontalAutoLayoutContainer:
                        Height: =Parent.TemplateHeight
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =10
                        Width: =Parent.TemplateWidth
                        ZIndex: =1

                        Image14_2 As image:
                            BorderColor: =App.Theme.Colors.Darker40
                            DisabledBorderColor: =RGBA(166, 166, 166, 1)
                            DisabledFill: =RGBA(244, 244, 244, 1)
                            Height: =30
                            Image: |-
                                =Switch(
                                    Lower(
                                        Last(
                                            Split(
                                                ThisItem.PolicyDocumentName,
                                                "."
                                            )
                                        ).Value
                                    ),
                                    "pdf",
                                    "data:image/svg+xml;utf8, " & EncodeUrl(
                                        Substitute(
                                            pdfIcon,
                                            "currentColor",
                                            pdfColorText
                                        )
                                    ),
                                    "xlsx",
                                    "data:image/svg+xml;utf8, " & EncodeUrl(
                                        Substitute(
                                            excelDocIcon,
                                            "currentColor",
                                            excelColorText
                                        )
                                    ),
                                    "pptx",
                                    "data:image/svg+xml;utf8, " & EncodeUrl(
                                        Substitute(
                                            powerPointIcon,
                                            "currentColor",
                                            pptColorText
                                        )
                                    ),
                                    "docx",
                                    "data:image/svg+xml;utf8, " & EncodeUrl(
                                        Substitute(
                                            wordDocIcon,
                                            "currentColor",
                                            wordColorText
                                        )
                                    ),
                                    "doc",
                                    "data:image/svg+xml;utf8, " & EncodeUrl(
                                        Substitute(
                                            wordDocIcon,
                                            "currentColor",
                                            wordColorText
                                        )
                                    ),
                                    "jpeg",
                                    "data:image/svg+xml;utf8, " & EncodeUrl(
                                        Substitute(
                                            imageIcon,
                                            "currentColor",
                                            imageColorText
                                        )
                                    ),
                                    "jpg",
                                    "data:image/svg+xml;utf8, " & EncodeUrl(
                                        Substitute(
                                            imageIcon,
                                            "currentColor",
                                            imageColorText
                                        )
                                    ),
                                    "png",
                                    "data:image/svg+xml;utf8, " & EncodeUrl(
                                        Substitute(
                                            imageIcon,
                                            "currentColor",
                                            imageColorText
                                        )
                                    )
                                )
                            Width: =30
                            ZIndex: =1

                        policyName_1 As Text:
                            AlignInContainer: =AlignInContainer.Stretch
                            AutoHeight: =true
                            BorderColor: =
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FillPortions: =1
                            FontColor: =
                            Height: =Parent.Height
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            Text: =ThisItem.PolicyName
                            Width: =168
                            X: =27
                            Y: =2
                            ZIndex: =2

                        policyDocBlob_1 As Text:
                            BorderColor: =
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FontColor: =
                            Height: =20
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            Text: =ThisItem.PolicyDocument
                            Visible: =false
                            Width: =309
                            X: =111
                            Y: =8
                            ZIndex: =3

                        DocumentName_1 As Text:
                            AlignInContainer: =AlignInContainer.Stretch
                            AutoHeight: =true
                            BorderColor: =
                            BorderStyle: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FillPortions: =1
                            FontColor: =
                            Height: =66
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            Text: =ThisItem.PolicyDocumentName
                            Width: =219
                            X: =184
                            Y: =1
                            ZIndex: =4

                        Delete_container_2 As groupContainer.manualLayoutContainer:
                            FillPortions: =0
                            Height: =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            Visible: =DataCardValue8.Selected.Value = 'Approval Status'.Rejected || DataCardValue8.Selected.Value = 'Approval Status'.New
                            Width: =20
                            ZIndex: =5

                            Image12_4 As image:
                                BorderColor: =App.Theme.Colors.Darker40
                                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                Height: =Parent.Height
                                Image: =trash
                                Width: =Parent.Width
                                ZIndex: =1

                            Button1_6 As button:
                                BorderColor: =App.Theme.Colors.Primary
                                BorderStyle: =BorderStyle.None
                                Color: =RGBA(0, 0, 0, 0)
                                DisabledBorderColor: =RGBA(244, 244, 244, 1)
                                DisabledColor: =RGBA(166, 166, 166, 1)
                                DisabledFill: =RGBA(244, 244, 244, 1)
                                Fill: =RGBA(0, 0, 0, 0)
                                Font: =App.Theme.Font
                                FontWeight: =FontWeight.Semibold
                                Height: =Parent.Height
                                HoverBorderColor: =App.Theme.Colors.Darker10
                                HoverColor: =RGBA(0, 0, 0, 0)
                                HoverFill: =RGBA(0, 0, 0, 0)
                                OnSelect: |
                                    =Remove(
                                        policyDocuments,
                                        ThisItem
                                    );
                                    Remove(
                                        myDocs,
                                        ThisItem
                                    );
                                    Remove(
                                        polNames,
                                        LookUp(
                                            polNames,
                                             PolicyName = ThisItem.PolicyName 
                                        )
                                    );
                                    Remove(
                                        'POLICY DOCUMENTS',
                                        LookUp(
                                            'POLICY DOCUMENTS',
                                            ID = ThisItem.policyID
                                        )
                                    );
                                PressedBorderColor: =App.Theme.Colors.Darker40
                                PressedColor: =Self.Color
                                PressedFill: =RGBA(0, 0, 0, 0)
                                Size: =15
                                Text: ="Button"
                                Width: =Parent.Width
                                ZIndex: =2

                        Icon10_2 As icon.Download:
                            BorderColor: =App.Theme.Colors.Darker40
                            Color: =App.Theme.Colors.Darker30
                            DisabledBorderColor: =RGBA(166, 166, 166, 1)
                            DisabledColor: =RGBA(244, 244, 244, 1)
                            Height: =30
                            Icon: =Icon.Download
                            OnSelect: =Download(ThisItem.PolicyDocumentURI)
                            Visible: =ThisItem.PolicyDocumentURI <> ""
                            Width: =30
                            ZIndex: =6

                buttons_2 As groupContainer.horizontalAutoLayoutContainer:
                    FillPortions: =0
                    Height: =70
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =30
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =9

                    close_button_1 As button:
                        BorderColor: =RGBA(17,65,133,1)
                        DisabledBorderColor: =RGBA(244, 244, 244, 1)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        Fill: =RGBA(17,65,133,1)
                        Font: =App.Theme.Font
                        FontWeight: =FontWeight.Semibold
                        HoverBorderColor: =App.Theme.Colors.Darker10
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(17,65,133,1), 20%)
                        OnSelect: |-
                            =UpdateContext({openForm:false})
                        PressedBorderColor: =App.Theme.Colors.Darker40
                        PressedColor: =Self.Color
                        PressedFill: =RGBA(17,65,133,1)
                        RadiusBottomLeft: =6
                        RadiusBottomRight: =6
                        RadiusTopLeft: =6
                        RadiusTopRight: =6
                        Size: =10
                        Text: ="Close"
                        Visible: =Switch(DataCardValue8.Selected.Value, 'Approval Status'.Approved,true,'Approval Status'.Pending, true, 'Approval Status'.Rejected,false,false)
                        ZIndex: =1

                    cancel_button_1 As button:
                        BorderColor: =RGBA(17,65,133,1)
                        Color: =RGBA(17,65,133,1)
                        DisabledBorderColor: =RGBA(244, 244, 244, 1)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        Fill: =Color.White
                        Font: =App.Theme.Font
                        FontWeight: =FontWeight.Semibold
                        HoverBorderColor: =App.Theme.Colors.Darker10
                        HoverFill: =ColorFade(RGBA(217,217,217,1), 20%)
                        OnSelect: |-
                            =UpdateContext({openForm: false});
                            Clear(myDocs);
                            Clear(policyDocuments);
                            Clear(polNames);
                            //Switch(Form4_2.Mode, FormMode.Edit,ViewForm(Form4_2),FormMode.New,UpdateContext({openForm:false}))
                        PressedBorderColor: =App.Theme.Colors.Darker40
                        PressedColor: =Self.Color
                        PressedFill: =Self.Fill
                        RadiusBottomLeft: =6
                        RadiusBottomRight: =6
                        RadiusTopLeft: =6
                        RadiusTopRight: =6
                        Size: =10
                        Text: ="Cancel"
                        Visible: =Switch(DataCardValue8.Selected.Value, 'Approval Status'.Approved,false,'Approval Status'.Pending, false, 'Approval Status'.Rejected,true,true)
                        ZIndex: =2

                    save_button_1 As button:
                        BorderColor: =RGBA(17,65,133,1)
                        DisabledBorderColor: =RGBA(244, 244, 244, 1)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        DisplayMode: |-
                            =Switch(Form4_2.Mode, FormMode.New, If(IsEmpty(policyDocuments), DisplayMode.Disabled, DisplayMode.Edit),DisplayMode.Edit)
                            
                            /*DisplayMode.Edit/*If(
                                And(
                                    IsBlank(ErrorMessage42_1.Text),
                                    IsBlank(ErrorMessage41_1.Text),
                                    IsBlank(ErrorMessage40_1.Text),
                                    IsBlank(ErrorMessage43_1.Text),
                                    IsBlank(ErrorMessage46_1.Text),
                                    IsBlank(ErrorMessage44_1.Text),
                                    IsBlank(ErrorMessage43_1.Text),
                                    IsBlank(ErrorMessage38_1.Text),
                                    IsBlank(ErrorMessage47_1.Text),
                                    IsBlank(ErrorMessage45_1.Text)
                                ),
                                DisplayMode.Edit,
                                DisplayMode.Disabled
                            )*/
                        Fill: =RGBA(17,65,133,1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Semibold
                        HoverBorderColor: =App.Theme.Colors.Darker10
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(17,65,133,1), 20%)
                        OnSelect: |-
                            =UpdateContext({action: "Submit"});UpdateContext({showPopUp:true});
                        PressedBorderColor: =App.Theme.Colors.Darker40
                        PressedColor: =Self.Color
                        PressedFill: =App.Theme.Colors.Darker40
                        RadiusBottomLeft: =6
                        RadiusBottomRight: =6
                        RadiusTopLeft: =6
                        RadiusTopRight: =6
                        Size: =10
                        Text: ="Submit"
                        Visible: =Switch(DataCardValue8.Selected.Value, 'Approval Status'.Approved,false,'Approval Status'.Pending, false, 'Approval Status'.Rejected,true,true)
                        ZIndex: =3

    Loading_3 As Loading:
        Visible: =showLoading
        ZIndex: =5

